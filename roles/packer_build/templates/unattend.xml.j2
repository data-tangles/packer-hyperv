<?xml version="1.0" encoding="utf-8"?>
<unattend xmlns="urn:schemas-microsoft-com:unattend">
  <settings pass="specialize">
    <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <TimeZone>South Africa Standard Time</TimeZone>
	    <ProductKey>{{ product_key }}</ProductKey>
    </component>
    <component name="Microsoft-Windows-ServerManager-SvrMgrNc" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <DoNotOpenServerManagerAtLogon>true</DoNotOpenServerManagerAtLogon>
    </component>
  </settings>
  <settings pass="oobeSystem">
    <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <AutoLogon>
          <Password>
            <Value>{{ packer_admin_password }}</Value>
            <PlainText>true</PlainText>
          </Password>
            <Enabled>true</Enabled>
            <Username>Administrator</Username>
        </AutoLogon>
      <OOBE>
        <HideEULAPage>true</HideEULAPage>
        <HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>
        <HideLocalAccountScreen>true</HideLocalAccountScreen>
        <HideOEMRegistrationScreen>true</HideOEMRegistrationScreen>
        <HideOnlineAccountScreens>true</HideOnlineAccountScreens>
        <NetworkLocation>Work</NetworkLocation>
      </OOBE>
        <FirstLogonCommands>
          <SynchronousCommand wcm:action="add">
            <CommandLine>cmd.exe /c powershell -Command "Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force"</CommandLine>
            <Description>Set Execution Policy 64 Bit</Description>
            <Order>1</Order>
            <RequiresUserInput>true</RequiresUserInput>
          </SynchronousCommand>
          <SynchronousCommand wcm:action="add">
            <CommandLine>C:\Windows\SysWOW64\cmd.exe /c powershell -Command "Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force"</CommandLine>
            <Description>Set Execution Policy 32 Bit</Description>
            <Order>2</Order>
            <RequiresUserInput>true</RequiresUserInput>
          </SynchronousCommand>
          <SynchronousCommand wcm:action="add">
            <CommandLine>cmd.exe /c C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File e:\bootstrap.ps1</CommandLine>
            <Description>bootstrap</Description>
            <Order>3</Order>
            <RequiresUserInput>true</RequiresUserInput>
          </SynchronousCommand>
          <SynchronousCommand wcm:action="add">
            <CommandLine>cmd.exe /c C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File e:\winrm-config.ps1</CommandLine>
            <Description>WinRM Config</Description>
            <Order>4</Order>
            <RequiresUserInput>true</RequiresUserInput>
          </SynchronousCommand>
        </FirstLogonCommands>
        <UserAccounts>
          <AdministratorPassword>
            <Value>{{ packer_admin_password }}</Value>
            <PlainText>true</PlainText>
          </AdministratorPassword>
        </UserAccounts>
    </component>
      <component name="Microsoft-Windows-International-Core" processorArchitecture="x86" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
         <InputLocale>en-ZA</InputLocale>
         <SystemLocale>en-ZA</SystemLocale>
         <UILanguage>en-ZA</UILanguage>
         <UserLocale>en-ZA</UserLocale>
      </component>
  </settings>
</unattend>
